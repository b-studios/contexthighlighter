<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="styles/theme_brackets.css"></link>
<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
</head>
<body>
<pre class="code"><code id="globalscope"><% content %></code></pre>
<script>
jQuery(function(){
  
  jQuery('.function').each(function() {

    var el = jQuery(this),
        parent = el.offsetParent(),
        height = el.outerHeight(),
        posY = el.position().top;

        // calculuating the nesting depth inside this function
    var nesting = el.parents('.function').size();

    var bracket = jQuery('<div>', {
          'class': 'bracket level' + (nesting + 1)
        }).css({
          height: height,
          top: posY,
          left: nesting * 6
        });

    el.data('bracket', bracket);
    parent.append(bracket);
  });


  jQuery('.id').hover(function() {
    var el = jQuery(this),
        scope = el.data('scope')
    
    if (scope === 'globalscope' || !scope)
      return;

    jQuery('#' + scope).data('bracket').addClass('show-scope')
  }, function() {
    var el = jQuery(this),
        scope = el.data('scope')
    
    if (scope === 'globalscope' || !scope)
      return;
    
    jQuery('#' + scope + '.function').data('bracket').removeClass('show-scope')
  });
});
</script>
</body>
</html>
